class ZTab{constructor(selector,options={}){this.container=document.querySelector(selector);if(!this.container)return;this.opt=Object.assign({tabSelector:"li a",activeClassName:"Ztab--active",remember:false,onChange:null},options);this.tabs=Array.from(this.container.querySelectorAll(this.opt.tabSelector));this.panels=this.getPanels();if(this.tabs.length===0||this.tabs.length!==this.panels.length)return;this._cleanRegex=/[^a-zA-Z0-9]/g;this.paramKey=selector.replace(this._cleanRegex,"");this._handleClick=this._handleClick.bind(this);this._init()}getPanels(){return this.tabs.map(tab=>document.querySelector(tab.getAttribute("href"))).filter(Boolean)}_init(){const params=new URLSearchParams(window.location.search);const savedTabId=params.get(this.paramKey);const initialTab=this.opt.remember&&savedTabId?this.tabs.find(t=>t.getAttribute("href").replace(this._cleanRegex,"")===savedTabId)||this.tabs[0]:this.tabs[0];this.currentTab=initialTab;this._activateTab(initialTab,false,false);this.tabs.forEach(tab=>tab.addEventListener("click",this._handleClick))}_handleClick(event){event.preventDefault();const tab=event.currentTarget;if(this.currentTab!==tab){this.currentTab=tab;this._activateTab(tab)}}_activateTab(tab,triggerOnChange=true,updateURL=this.opt.remember){this.tabs.forEach(t=>t.closest("li").classList.remove(this.opt.activeClassName));tab.closest("li").classList.add(this.opt.activeClassName);this.panels.forEach(p=>p.hidden=true);const activePanel=document.querySelector(tab.getAttribute("href"));if(activePanel)activePanel.hidden=false;if(updateURL){const params=new URLSearchParams(window.location.search);params.set(this.paramKey,tab.getAttribute("href").replace(this._cleanRegex,""));window.history.replaceState(null,null,`?${params.toString()}`)}if(triggerOnChange&&typeof this.opt.onChange==="function"){this.opt.onChange({tab:tab,panel:activePanel})}}destroy(){this.tabs.forEach(tab=>tab.removeEventListener("click",this._handleClick));this.tabs.forEach(t=>t.closest("li").classList.remove(this.opt.activeClassName));this.panels.forEach(p=>p.hidden=false);this.container=null;this.tabs=null;this.panels=null}switch(target){const tab=this.tabs.find(t=>t.getAttribute("href")===target);if(tab){this.currentTab=tab;this._activateTab(tab)}else{console.error(`ZTab: Tab with selector "${target}" not found.`)}}}class ZPop{static elements=[];constructor(options={}){if(!options.content&&!options.templateId){console.error("You must provide one of 'content' or 'templateId'.");return}if(options.content&&options.templateId){options.templateId=null;console.warn("Both 'content' and 'templateId' are specified. 'content' will take precedence, and 'templateId' will be ignored.")}if(options.templateId){this.template=document.querySelector(`#${options.templateId}`);if(!this.template){console.error(`#${options.templateId} does not exist!`);return}}this.opt=Object.assign({enableScrollLock:true,destroyOnClose:true,footer:false,cssClass:[],closeMethods:["button","overlay","escape"],scrollLockTarget:()=>document.body,onOpen:null,onClose:null},options);this.content=this.opt.content;this._footerButtons=[];this._handleEscapeKey=this._handleEscapeKey.bind(this)}_build(){this._backdrop=document.createElement("div");this._backdrop.className="Zpop";const container=document.createElement("div");container.className="Zpop__container";this.opt.cssClass.forEach(cls=>cls&&container.classList.add(cls));if(this.opt.closeMethods.includes("button")){const closeBtn=this._createButton("&times;","Zpop__close",()=>this.close());container.append(closeBtn)}this._modalContent=document.createElement("div");this._modalContent.className="Zpop__content";this._updateContent();container.append(this._modalContent);if(this.opt.footer){this._modalFooter=document.createElement("div");this._modalFooter.className="Zpop__footer";container.append(this._modalFooter);this._renderFooter()}this._backdrop.append(container);document.body.append(this._backdrop)}_updateContent(){if(!this._modalContent)return;if(this.content){this._modalContent.innerHTML=this.content}else if(this.template){this._modalContent.innerHTML="";this._modalContent.append(this.template.content.cloneNode(true))}}_renderFooter(){if(!this._modalFooter)return;this._modalFooter.innerHTML=this._footerContent||"";this._footerButtons.forEach(btn=>this._modalFooter.append(btn))}addFooterButton(title,cssClass,callback){const button=this._createButton(title,cssClass,callback);this._footerButtons.push(button);if(this._modalFooter)this._renderFooter()}_onTransitionEnd(callback){const onEnd=e=>{if(["opacity","transform","visibility"].includes(e.propertyName)){this._backdrop.removeEventListener("transitionend",onEnd);if(typeof callback==="function")callback()}};this._backdrop.addEventListener("transitionend",onEnd)}open(){if(!this._backdrop)this._build();ZPop.elements.push(this);this._backdrop.offsetHeight;this._backdrop.classList.add("Zpop--show");if(this.opt.enableScrollLock)this._lockScroll();if(this.opt.closeMethods.includes("overlay")){this._backdrop.onclick=e=>{if(e.target===this._backdrop)this.close()}}if(this.opt.closeMethods.includes("escape")){document.addEventListener("keydown",this._handleEscapeKey)}this._onTransitionEnd(this.opt.onOpen);return this}_handleEscapeKey(e){if(e.key==="Escape"&&this.opt.closeMethods.includes("escape")){this.close()}}_lockScroll(){const target=this.opt.scrollLockTarget();if(ZPop.elements.length===1&&this._hasScrollbar(target)){const scrollWidth=this._getScrollbarWidth();target.style.paddingRight=`${scrollWidth}px`;target.classList.add("Zpop--no-scroll")}}_unlockScroll(){const target=this.opt.scrollLockTarget();if(ZPop.elements.length===0){target.style.paddingRight="";target.classList.remove("Zpop--no-scroll")}}close(){const index=ZPop.elements.indexOf(this);if(index>-1)ZPop.elements.splice(index,1);this._backdrop.classList.remove("Zpop--show");document.removeEventListener("keydown",this._handleEscapeKey);this._onTransitionEnd(()=>{this._unlockScroll();if(typeof this.opt.onClose==="function")this.opt.onClose();if(this.opt.destroyOnClose){this._backdrop.remove();this._backdrop=null}})}_createButton(text,cssClass,callback){const btn=document.createElement("button");btn.innerHTML=text;if(cssClass){cssClass.split(" ").forEach(cls=>btn.classList.add(cls))}btn.onclick=e=>{e.stopPropagation();if(typeof callback==="function")callback(e)};return btn}_hasScrollbar(target){return target===document.body?window.innerWidth>document.documentElement.clientWidth:target.scrollHeight>target.clientHeight}_getScrollbarWidth(){return window.innerWidth-document.documentElement.clientWidth}setContent(content){this.content=content;this._updateContent()}setFooterContent(content){this._footerContent=content;this._renderFooter()}destroy(){if(this._backdrop){this._backdrop.remove();this._backdrop=null}const index=ZPop.elements.indexOf(this);if(index>-1)ZPop.elements.splice(index,1);this._unlockScroll();document.removeEventListener("keydown",this._handleEscapeKey)}}class ZSlide{constructor(selector,options={}){this.container=document.querySelector(selector);if(!this.container){console.error(`ZSlide: Container "${selector}" not found!`);return}this.opt=Object.assign({items:1,speed:300,loop:false,nav:true,controls:true,controlsText:["<",">"],prevButton:null,nextButton:null,slideBy:1,autoplay:false,autoplayTimeout:3e3,autoplayHoverPause:true},options);this.originalSlides=Array.from(this.container.children);this.slides=this.originalSlides.slice(0);this.currentIndex=this.opt.loop?this._getCloneCount():0;this._init();this._updatePosition()}_init(){this.container.classList.add("Zslide-wrapper");this._createContent();this._createTrack();const showNav=this._getSlideCount()>this.opt.items;if(this.opt.controls&&showNav){this._createControls()}if(this.opt.nav&&showNav){this._createNav()}if(this.opt.autoplay){this._startAutoplay();if(this.opt.autoplayHoverPause){this.container.onmouseenter=()=>this._stopAutoplay();this.container.onmouseleave=()=>this._startAutoplay()}}}_startAutoplay(){if(this.autoplayTimer)return;const slideBy=this._getSlideBy();this.autoplayTimer=setInterval(()=>{this.moveSlide(slideBy)},this.opt.autoplayTimeout)}_stopAutoplay(){clearInterval(this.autoplayTimer);this.autoplayTimer=null}_createContent(){this.content=document.createElement("div");this.content.className="Zslide-content";this.container.appendChild(this.content)}_getCloneCount(){const slideCount=this._getSlideCount();if(slideCount<=this.opt.items)return 0;const slideBy=this._getSlideBy();const cloneCount=slideBy+this.opt.items;return cloneCount>slideCount?slideCount:cloneCount}_createTrack(){this.track=document.createElement("div");this.track.className="Zslide-track";const cloneCount=this._getCloneCount();if(this.opt.loop&&cloneCount>0){const cloneHead=this.slides.slice(-cloneCount).map(node=>node.cloneNode(true));const cloneTail=this.slides.slice(0,cloneCount).map(node=>node.cloneNode(true));this.slides=cloneHead.concat(this.slides.concat(cloneTail))}this.slides.forEach(slide=>{slide.classList.add("Zslide-slide");slide.style.flexBasis=`calc(100% / ${this.opt.items})`;this.track.appendChild(slide)});this.content.appendChild(this.track)}_getSlideBy(){return this.opt.slideBy==="page"?this.opt.items:this.opt.slideBy}_createControls(){this.prevBtn=this.opt.prevButton?document.querySelector(this.opt.prevButton):document.createElement("button");this.nextBtn=this.opt.nextButton?document.querySelector(this.opt.nextButton):document.createElement("button");if(!this.opt.prevButton){this.prevBtn.textContent=this.opt.controlsText[0];this.prevBtn.className="Zslide-prev";this.content.appendChild(this.prevBtn)}if(!this.opt.nextButton){this.nextBtn.textContent=this.opt.controlsText[1];this.nextBtn.className="Zslide-next";this.content.appendChild(this.nextBtn)}const slideBy=this._getSlideBy();this.prevBtn.onclick=()=>this.moveSlide(-slideBy);this.nextBtn.onclick=()=>this.moveSlide(slideBy)}_getSlideCount(){return this.originalSlides.length}_createNav(){this.navWrapper=document.createElement("div");this.navWrapper.className="Zslide-nav";const slideCount=this._getSlideCount();const pageCount=Math.ceil(slideCount/this.opt.items);for(let i=0;i<pageCount;i++){const dot=document.createElement("button");dot.className="Zslide-dot";if(i===0)dot.classList.add("active");dot.onclick=()=>{this.currentIndex=this.opt.loop?i*this.opt.items+this._getCloneCount():i*this.opt.items;this._updatePosition()};this.navWrapper.appendChild(dot)}this.container.appendChild(this.navWrapper)}moveSlide(step){if(this._isAnimating)return;const slideCount=this.originalSlides.length;this._isAnimating=true;this.currentIndex+=step;this._updatePosition();if(this.opt.loop){this.track.addEventListener("transitionend",()=>{const clones=this._getCloneCount();if(this.currentIndex>=slideCount+clones){this.currentIndex-=slideCount;this._updatePosition(true)}else if(this.currentIndex<clones){this.currentIndex+=slideCount;this._updatePosition(true)}this._isAnimating=false},{once:true})}else{this.currentIndex=Math.max(0,Math.min(this.currentIndex,slideCount-this.opt.items));this._updatePosition();setTimeout(()=>{this._isAnimating=false},this.opt.speed)}}_updateNav(){if(!this.navWrapper)return;const slideCount=this.originalSlides.length;let activeDot=0;if(this.opt.loop){const clones=this._getCloneCount();activeDot=(this.currentIndex-clones+slideCount)%slideCount}else{activeDot=this.currentIndex}const dotIndex=Math.floor(activeDot/(this.opt.slideBy==="page"?this.opt.items:1));Array.from(this.navWrapper.children).forEach((dot,i)=>{dot.classList.toggle("active",i===dotIndex)})}_updatePosition(instant=false){if(!this.track)return;this.track.style.transition=instant?"none":`transform ease ${this.opt.speed}ms`;const offset=-(this.currentIndex*(100/this.opt.items));this.track.style.transform=`translateX(${offset}%)`;this._updateNav()}}